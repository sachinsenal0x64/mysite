"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const prefetch_1 = require("./prefetch");
/**
 * Adds event listener for messages sent by service-worker if it wasn't added already
 */
function listenForSwMessages() {
    const { serviceWorker } = navigator;
    // In case service-worker was not registered or eventListener for messages was already added, do nothing
    // @ts-ignore
    if (typeof serviceWorker === 'undefined' || window.swEventListenerAdded) {
        return;
    }
    serviceWorker.addEventListener('message', event => {
        if (event.data.action === 'prefetch') {
            (0, prefetch_1.prefetch)(event.data.url, event.data.as, event.data.options);
        }
    });
    // @ts-ignore
    window.swEventListenerAdded = true;
}
exports.default = listenForSwMessages;
