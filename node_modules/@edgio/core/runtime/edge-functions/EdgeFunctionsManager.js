"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const EdgeFunctionsWorkerManager_1 = __importDefault(require("./EdgeFunctionsWorkerManager"));
/// Creates, runs, offers services to, kills and otherwise manages Edge Functions.
class EdgeFunctionsManager {
    static instance() {
        return EdgeFunctionsManager.s_instance;
    }
    async runEdgeFunction(context, path, sysVars, envVars, usrVars, httpVars, rawBody) {
        // We give the edge functions access to the entire request body if it's not empty.
        const maybeRawBody = (rawBody === null || rawBody === void 0 ? void 0 : rawBody.byteLength) ? rawBody : undefined;
        const worker = new EdgeFunctionsWorkerManager_1.default(context, maybeRawBody, path, sysVars, envVars, usrVars, httpVars);
        return worker.runEdgeFunction();
    }
}
exports.default = EdgeFunctionsManager;
EdgeFunctionsManager.s_instance = new EdgeFunctionsManager();
