"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const buffer_1 = require("buffer");
// Base64 validation regex from https://stackoverflow.com/a/475217
const validBase64Regex = /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/;
/**
 * Decodes an input string to base64 with validation.
 *
 * NodeJS's `Buffer.from` method silently ignores encoding issues by default,
 * so encoding validation must be done manually before calling into it.
 *
 * See: https://github.com/nodejs/node/issues/8569
 * @param base64Input
 */
function decodeBase64ToBuffer(base64Input) {
    if (!validBase64Regex.test(base64Input)) {
        throw new Error(`Invalid base64 string`);
    }
    return buffer_1.Buffer.from(base64Input, 'base64');
}
exports.default = decodeBase64ToBuffer;
